diff --git a/lib/monkey/deps/flb_libco/libco.c b/lib/monkey/deps/flb_libco/libco.c
index e0101d23..37bbb65d 100644
--- a/lib/monkey/deps/flb_libco/libco.c
+++ b/lib/monkey/deps/flb_libco/libco.c
@@ -16,7 +16,9 @@
     #include "arm.c"
   #elif defined(__aarch64__)
     #include "aarch64.c"
-  #elif defined(_ARCH_PPC)
+  #elif defined(__powerpc64__) && defined(_CALL_ELF) && (_CALL_ELF == 2)
+    #include "ppc64le.c"
+  #elif defined(_ARCH_PPC) && !defined(__LITTLE_ENDIAN__)
     #include "ppc.c"
   #elif defined(_WIN32)
     #include "fiber.c"
diff --git a/lib/monkey/deps/flb_libco/settings.h b/lib/monkey/deps/flb_libco/settings.h
index 0c3db68e..c2c24776 100644
--- a/lib/monkey/deps/flb_libco/settings.h
+++ b/lib/monkey/deps/flb_libco/settings.h
@@ -48,5 +48,16 @@
   #define text_section __attribute__((section(".text#")))
 #endif
 
+#if !defined(LIBCO_ASSERT)
+  #include <assert.h>
+  #define LIBCO_ASSERT assert
+#endif
+
+#if !defined(LIBCO_MALLOC) || !defined(LIBCO_FREE)
+  #include <stdlib.h>
+  #define LIBCO_MALLOC malloc
+  #define LIBCO_FREE   free
+#endif
+
 /* ifdef LIBCO_C */
 #endif
